<html><head>
<title>Установление входящих соединений</title>
		    <style type="text/css">
A.noneline { font-family: Arial, Serif; text-decoration: none; }
FONT.arial { font-family: Arial, Serif; }
TD.arial   { font-family: Arial, Serif; }
TH.arial   { font-family: Arial, Serif; }
PRE        { font-family: Monospace; color: navy; }
SAMP       { font-family: Monospace; color: navy; }
TT         { font-family: Monospace; color: navy; }
VAR        { font-family: Monospace; color: navy; }
</style>
</head>
<body bgcolor="#FFF5EE" text="#000000" link="#FF0000" alink="#FF0000" vlink="#A52A2A">
<basefont size="3">
<h3 align=center>Глава 5. Установление входящих соединений<br>
(как ответить позвонившему Вам модему)</h3>
<p align=justify>В этой главе описано,  как ответить на вызов удаленного
модема,  а также как ответить голосом,  а потом перейти в режим
передачи данных.
<a name=1></a>
<h4>Автоматический ответ на входящий звонок</h4>
<p align=justify>Если вам  требуется,  чтобы модем автоматически отвечал
на звонки, проделайте следующее:
<ol>
<li>Введите команду ATS0=n где n  -  количество  звонков
которое модем пропустит, прежде чем перейти в режим ответа. Допустимые значения 1-255, 0 (по умолчанию) означает запрет автоответа.  Например,  после команды ATS0=4,  модем будет отвечать
только после 4-го звонка.
<li>Нажмите &lt;Enter&gt;, на что модем ответит OK. У внешнего
модема, кроме того, должен загореться индикатор 'AA'
<li>Автоответ  будет работать до тех пор,  пока не произойдет сброс модема или не будет отключено питание.  При этом в
регистр S0 будет записано значение,  хранящееся в NVRAM.  NVRAM
(перезаписываемая постоянная память, ППЗУ) - особый тип памяти,
установленной в Вашем модеме, где хранятся редко изменяемые параметры настройки. В отличие от RAM (оперативная память), записанное  в  NVRAM содержимое не разрушается при выключении питания,  а в отличие от ROM (постоянная память),  содержимое NVRAM
можно модифицировать.
</ol>
<blockquote>
<p align=justify>Внимание! Далеко  не  каждая коммуникационная программа
способна работать с модемом в режиме автоответа.  Многие  программы  предпочитают самостоятельно обнаружить звонок и выдать в
модем команду ответа A. Прежде, чем устанавливать режим автоответа, ознакомьтесь с документацией на программное обеспечение.
</blockquote>
<p><i>Как работает автоответ</i>
<p align=justify>Если Ваш модем настроен на  режим  автоответа,  то  при
звонке на него с удаленного модема будет происходить следующее:
<ol>
<li>Звонит  телефонный  аппарат,  подключенный  к гнезду
Phone модема,  модем выдает сообщения RING.  У внешнего  модема
может мигать индикатор 'AA'.  В случае,  если динамик модема не
отключен командой L0, модем так же издает звуковой сигнал.
<li>Модем подсчитывает звонки и переходит в режим  ответа, отсчитав число звонков указанное в регистре S0. Модем подключается к линии и начинает ожидать сигнал несущей от  вызывающего  модема.  Если в течении времени,  заданного регистром S7,
соединение не установлено, модем отключается от линии и возвращается в командный режим.
<li>Если сигнал несущей получен, модем устанавливает соединение с удаленным модемом и переходит к  фазе  обмена  подтверждениями (handshake).
<li>Модем выдает соответствующее сообщение CONNECT,  переключается в режим данных и переводит линию DCD интерфейса  RS-232C
в состояние 'On', сигнализируя о готовности к обмену данными.
</ol>
<a name=2></a>
<h4>Как ответить на звонок вручную</h4>
<p align=justify>Чтобы отключить режим автоответа,  следует  командой  ATS0=0
записать в регистр S0 значение 0,  при этом, реагируя на входящие звонки, модем будет только выдавать сообщение RING. Перейти
в режим ответа в этом случае можно при помощи ввода вручную команды A.
<p align=justify>После детектирования сигнала звонка (получения  сообщения RING) введите командную строку AT A&lt;Enter&gt;,  при этом модем
подключится к линии,  установит соединение и перейдет  в  режим
данных.
<a name=3></a>
<h4>Разрыв соединения</h4>
<p align=justify>Чтобы разорвать  соединение  после  завершения передачи данных,
необходимо сделать следующее:
<ol>
<li>Для перехода из режима данных в режим команд наберите  Escape-последовательность,  (по умолчанию "+++").  Модем вернется в
режим команд.
<li>Модем будет готов к приему очередных команд через время  заданное в регистре S12 (стандартно 1с), и подтвердит это выдачей
сообщения OK.
<li>Введите команду ATH.  Не забудьте завершить ее нажатием клавиши  &lt;Enter&gt;.  Модем  при этом отсоединится от линии ("положит
трубку"), выдаст Вам сообщение OK и вернется в командный режим.
</ol>
<p align=justify>Если Ваше коммуникационное ПО имеет специальную команду
для разрыва соединения, вы можете так же воспользоваться ей.
<a name=4></a>
<h4>Регистры, влияющие на ответ</h4>
<p align=justify>Поведение модема при ответе управляется различными  регистрами. Регистры, влияющие на ответ и разрыв соединения, приведены в следующей таблице.
<table border=1>
<tr valign=top><th>Регистр<th>Значение по умолчанию<th>Функция</tr>
<tr valign=top><td>S0<td align=center>0<td>Число звонков, после которого модем автоматически  отвечает на вызов. 0 - автоматический ответ запрещен</tr>
<tr valign=top><td>S7<td align=center>30<td>Время ожидания несущей вызывающего модема в секундах</tr>
<tr valign=top><td>S9<td align=center>6<td>Время в 1/10 с, в течении которого должна присутствовать несущая вызывающего
модема, чтобы Ваш модем ее распознал</tr>
<tr valign=top><td>S10<td align=center>14 - соотв.<br>1,4 с<td>Время в 1/10 c, в течение которого модем ожидает возвращения  сигнала несущей удаленного модема  перед  разрывом соединения, если несущая потеряна.</tr>
</table>
<p><center><p>
<font size=-1>
<a href="gl4.htm">Назад</a> | <a href="index.htm">Содержание</a> | <a href="gl6.htm">Вперед</a></font></center></p>
</p>
<hr noshade>
<center>
<font size=1 class=arial>
Copyright &copy; <a href="http://www.citmgu.ru/" class=noneline>CIT</a>
</font></center></body></html>
